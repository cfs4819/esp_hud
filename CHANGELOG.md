# 更新日志

## 版本规则

本项目使用 `MAJOR.MINOR.PATCH` 版本号，并使用 ISO 8601 日期格式（`YYYY-MM-DD`）记录发布日期。

- `MAJOR`（`1.x.x`）：当出现不兼容的 API/协议/数据格式变更时递增。
- `MINOR`（`x.1.x`）：当新增向后兼容功能时递增。
- `PATCH`（`x.x.1`）：当进行向后兼容的问题修复、性能优化或内部重构时递增。

说明：
- 版本术语遵循 `ISO/IEC/IEEE 24765`（软件版本标识相关定义）。
- 日期表示遵循 `ISO 8601`。

## [0.4.1] - 2026-02-12

### 变更
- 修复地图 PNG 刷新中透明通道丢失问题：接收端缓存不再强制降级为 `RGB565`，改为按解码结果保留 `LV_IMG_CF_TRUE_COLOR` 或 `LV_IMG_CF_TRUE_COLOR_ALPHA`。

## [0.4.0] - 2026-02-08

### 新增
- 增加“屏幕休眠/唤醒”能力
- MSG 协议新增命令字 `CMD`，支持：
  - `0x00`：状态数据（原有业务）
  - `0x01`：重启设备
- 上位机 demo 同步支持新 MSG 协议，并可发送重启命令用于联调。

### 变更
- 电源策略从“系统睡眠”调整为“仅 UI 级休眠”（息屏 + 暂停 LVGL），避免设备进入睡眠后无法可靠唤醒。
- 增加 USB 接收活动时间跟踪，用于驱动空闲判断与自动恢复流程。
- README 同步更新 MSG 协议和上位机使用示例。

## [0.3.1] - 2026-02-08

### 变更
- 地图图片改为“收到 PNG 后一次解码并缓存”，后续显示直接复用缓存，降低重复解码开销。

## [0.3.0] - 2026-02-08

### 新增
- 仪表新增更多显示字段：油量、总里程、行程里程、室外温度、电池电压。
- 上位机 demo 增加更真实的动态数据模拟。

### 变更
- 消息与图片处理改为双通道解耦，状态更新优先保证实时性，图片更新优先保留最新内容。
- 图像更新流程优化，降低延迟和资源争用风险。
- 渲染与任务参数调优，整体显示与接收稳定性提升。
- README 增补线程与队列模型说明。

## [0.2.1] - 2026-02-08

### 变更
- 显示缓冲迁移到 PSRAM，缓解内部内存压力。

## [0.2.0] - 2026-02-08

### 新增
- 上位机示例支持远程轨迹图拉取与更丰富图片发送参数。

### 变更
- UI 更新机制升级为消息/图片分流处理，减少互相阻塞。
- 页面结构与部分默认显示行为做了优化。

## [0.1.0] - 2026-02-08

### 新增
- 完成项目基础框架、仪表 UI、USB 数据链路（MSG/IMG）和上位机示例。
